<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> HowTo Trun Off IPv6 in CentOS 6.x · SAMZONG</title><meta name="description" content="HowTo Trun Off IPv6 in CentOS 6.x - SAMZONG"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://samzong.me/atom.xml" title="SAMZONG"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">HowTo Trun Off IPv6 in CentOS 6.x</h1><div class="post-info">Jul 29, 2016</div><div class="post-content"><h2 id="1-CentOS-6-x"><a href="#1-CentOS-6-x" class="headerlink" title="1. CentOS 6.x"></a>1. CentOS 6.x</h2><p>CentOS 6 上是默认打开了IPv6，但其实在我们实际使用中很难用到它，所以本篇的内容就是如何关闭IPv6。</p>
<p>＃ 可以看到 inet6 ，说明还没关闭。<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-attr">[root@ultraera ~]</span># <span class="selector-tag">ifconfig</span> <span class="selector-tag">eth0</span></div><div class="line"><span class="selector-tag">eth0</span>      <span class="selector-tag">Link</span> <span class="selector-tag">encap</span><span class="selector-pseudo">:Ethernet</span>  <span class="selector-tag">HWaddr</span> <span class="selector-tag">00</span><span class="selector-pseudo">:0C</span><span class="selector-pseudo">:29</span><span class="selector-pseudo">:3A</span><span class="selector-pseudo">:F9</span><span class="selector-pseudo">:6F</span></div><div class="line">          <span class="selector-tag">inet</span> <span class="selector-tag">addr</span><span class="selector-pseudo">:172.16.102.161</span>  <span class="selector-tag">Bcast</span><span class="selector-pseudo">:172.16.102.255</span>  <span class="selector-tag">Mask</span><span class="selector-pseudo">:255.255.255.0</span></div><div class="line">          <span class="selector-tag">inet6</span> <span class="selector-tag">addr</span>: <span class="selector-tag">fe80</span><span class="selector-pseudo">::20c</span><span class="selector-pseudo">:29ff</span><span class="selector-pseudo">:fe3a</span><span class="selector-pseudo">:f96f</span>/<span class="selector-tag">64</span> <span class="selector-tag">Scope</span><span class="selector-pseudo">:Link</span></div><div class="line">          <span class="selector-tag">UP</span> <span class="selector-tag">BROADCAST</span> <span class="selector-tag">RUNNING</span> <span class="selector-tag">MULTICAST</span>  <span class="selector-tag">MTU</span><span class="selector-pseudo">:1500</span>  <span class="selector-tag">Metric</span><span class="selector-pseudo">:1</span></div><div class="line">          <span class="selector-tag">RX</span> <span class="selector-tag">packets</span><span class="selector-pseudo">:199</span> <span class="selector-tag">errors</span><span class="selector-pseudo">:0</span> <span class="selector-tag">dropped</span><span class="selector-pseudo">:0</span> <span class="selector-tag">overruns</span><span class="selector-pseudo">:0</span> <span class="selector-tag">frame</span><span class="selector-pseudo">:0</span></div><div class="line">          <span class="selector-tag">TX</span> <span class="selector-tag">packets</span><span class="selector-pseudo">:122</span> <span class="selector-tag">errors</span><span class="selector-pseudo">:0</span> <span class="selector-tag">dropped</span><span class="selector-pseudo">:0</span> <span class="selector-tag">overruns</span><span class="selector-pseudo">:0</span> <span class="selector-tag">carrier</span><span class="selector-pseudo">:0</span></div><div class="line">          <span class="selector-tag">collisions</span><span class="selector-pseudo">:0</span> <span class="selector-tag">txqueuelen</span><span class="selector-pseudo">:1000</span></div><div class="line">          <span class="selector-tag">RX</span> <span class="selector-tag">bytes</span><span class="selector-pseudo">:20124</span> (<span class="number">19.6</span> KiB)  <span class="selector-tag">TX</span> <span class="selector-tag">bytes</span><span class="selector-pseudo">:17182</span> (<span class="number">16.7</span> KiB)</div></pre></td></tr></table></figure></p>
<p>＃ 修改/etc/modprobe.d/dist.conf<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root@ultraera ~]# vi /etc/modprobe.d/dist.conf</div><div class="line"><span class="comment"># 添加下面两行内容</span></div><div class="line">alias net-pf-10 off</div><div class="line">alias<span class="built_in"> ipv6 </span>off</div><div class="line"><span class="comment"># 保存退出，并且重新启动系统</span></div><div class="line"></div><div class="line"><span class="comment"># 开机不启动</span></div><div class="line">[root@ultraera ~]# chkconfig ip6tables off</div></pre></td></tr></table></figure></p>
<p>＃ 系统重启完成后，检查是否加载IPv6<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@ultraera</span> ~]<span class="meta"># lsmod | grep v6</span></div></pre></td></tr></table></figure></p>
<p>＃ 补充</p>
<ul>
<li><p>修改/etc/sysconfig/network，追加</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">NETWORKING_IPV6</span>=<span class="literal">no</span></div></pre></td></tr></table></figure>
</li>
<li><p>修改/etc/hosts文件，把ipv6的那句本地主机名解析的也注释掉</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#::<span class="number">1</span>   localhost localhost6 localhost6.localdomain6</div></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h2 id="2-CentOS-7-x"><a href="#2-CentOS-7-x" class="headerlink" title="2. CentOS 7.x"></a>2. CentOS 7.x</h2><h4 id="Setup-1-修改grub文件，在启动引导时不加载ipv6"><a href="#Setup-1-修改grub文件，在启动引导时不加载ipv6" class="headerlink" title="Setup 1. 修改grub文件，在启动引导时不加载ipv6"></a>Setup 1. 修改grub文件，在启动引导时不加载ipv6</h4><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@ultraera</span> ~]<span class="meta"># vim /etc/default/grub</span></div><div class="line"></div><div class="line"><span class="meta"># 在GRUB_CMDLINE_LINUX=<span class="string">" "</span> ,中增加</span></div><div class="line">ipv6.disable＝<span class="number">1</span></div><div class="line"></div><div class="line"><span class="meta"># 重新生产启动引导文件，注意，这里重启系统是没用的，需要手动重建引导文件</span></div><div class="line">[root<span class="symbol">@ultraera</span> ~]<span class="meta"># grub2-mkconfig -o /boot/grub2/grub.cfg</span></div><div class="line">[root<span class="symbol">@ultraera</span> ~]<span class="meta"># reboot</span></div></pre></td></tr></table></figure>
<p>＃ 验证是否关闭<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@ultraera</span> ~]<span class="meta"># lsmod | grep ipv6</span></div></pre></td></tr></table></figure></p>
<h4 id="Setup-2-第二种方式"><a href="#Setup-2-第二种方式" class="headerlink" title="Setup 2. 第二种方式"></a>Setup 2. 第二种方式</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 修改/etc/sysctl.<span class="keyword">conf</span>,增加以下：</div><div class="line"><span class="keyword">net</span>.ipv6.<span class="keyword">conf</span>.all.disable_ipv6 = 1</div><div class="line"></div><div class="line">reboot</div></pre></td></tr></table></figure>
<blockquote>
<p>IPv6是默认支持的，所以当你要重新开起IPv6支持时，将以上添加的指令注释掉即可。</p>
<font color="red"><b>之前碰到过安装某些服务时，不能启动，后来检查原因是因为关闭ipv6的问题，因为在这些服务的conf文件，指定了类似监听ipv6,因为关闭了ipv6导致服务无法启动，将其关闭即可。<b></b></b></font>

</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2016/08/01/insert-music/" class="prev">PREV</a><a href="/2016/07/27/install-kvm-web-manage-server-webvirtmgr/" class="next">NEXT</a></div><div class="copyright"><p>© 2012 - 2017 <a href="https://samzong.me">SAMZONG</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>