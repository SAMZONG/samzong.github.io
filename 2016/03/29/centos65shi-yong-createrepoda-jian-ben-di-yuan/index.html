<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> CentOS 6(1) 使用createrepo搭建本地源 · SAMZONG</title><meta name="description" content="CentOS 6(1) 使用createrepo搭建本地源 - SAMZONG"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://samzong.me/atom.xml" title="SAMZONG"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">CentOS 6(1) 使用createrepo搭建本地源</h1><div class="post-info">Mar 29, 2016</div><div class="post-content"><blockquote>
<p>Tips: 本地搭建本地yum源采用的rpm全部来自CentOS-6.7-bin-DVD1&amp;DVD2</p>
</blockquote>
<h3 id="1-测试环境"><a href="#1-测试环境" class="headerlink" title="1. 测试环境"></a>1. 测试环境</h3><ul>
<li>MacBook Pro 15-inch i7 16GB</li>
<li>VMware Fushion 8 Pro</li>
<li>CentOS-6.7-i686-minimal.iso</li>
</ul>
<p>因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</p>
<h3 id="2-实验步骤"><a href="#2-实验步骤" class="headerlink" title="2. 实验步骤"></a>2. 实验步骤</h3><figure class="highlight golo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 2.1 因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</span></div><div class="line">[adam<span class="meta">@ultraera</span> ~]$ su -</div><div class="line">Password:</div><div class="line">[root<span class="meta">@ultraera</span> ~]<span class="comment">#</span></div><div class="line"></div><div class="line"><span class="comment"># 2.2 首先在本地创建一个存放rpm包的目录，我这里选择直接在/下创建，你可以自定义：</span></div><div class="line">[root<span class="meta">@ultraera</span> ~]<span class="comment"># mkdir /yumload</span></div><div class="line">[root<span class="meta">@ultraera</span> ~]<span class="comment"># cd /yumload/</span></div><div class="line">[root<span class="meta">@ultraera</span> yumload]<span class="comment"># pwd</span></div><div class="line">/yumload</div><div class="line"><span class="comment"># 2.3 接下来把两张DVD中的Packages中的rpm包全部拷贝到/yumload:</span></div><div class="line">[root<span class="meta">@ultraera</span> yumload]<span class="comment"># cp /media/CentOS_6.5_Final/Packages/* ./</span></div><div class="line">[root<span class="meta">@ultraera</span> yumload]<span class="comment"># ll ./*.rpm | wc -l</span></div><div class="line"></div><div class="line"><span class="comment">#两张DVD一共有的rpm包的数量:</span></div><div class="line"><span class="number">4802</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 2.4 然后使用createrepo指令创建本地repo，CentOS6默认不安装createrepo，需要手动安装，没关系，在我们的DVD光盘中已经集成了createrepo的包，如果报需要依赖安装其他包的使用，依次安装即可。</span></div><div class="line"></div><div class="line">[root<span class="meta">@ultraera</span> yumload]<span class="comment"># rpm -ivh createrepo-0.9.9-18.el6.noarch.rpm</span></div><div class="line"></div><div class="line"><span class="comment"># 2.5 创建yum仓库，耐心等待，可以加-v参数列出执行信息</span></div><div class="line">[root<span class="meta">@ultraera</span> yumload]<span class="comment"># createrepo /yumload/</span></div><div class="line">Spawning worker <span class="number">0</span> <span class="keyword">with</span> <span class="number">4802</span> pkgs</div><div class="line">Workers Finished</div><div class="line">Gathering worker results</div><div class="line">Saving Primary metadata</div><div class="line">Saving file lists metadata</div><div class="line">Saving other metadata</div><div class="line">Generating sqlite DBs</div><div class="line">Sqlite DBs complete</div><div class="line">[root<span class="meta">@ultraera</span> yumload]<span class="comment">#</span></div><div class="line"></div><div class="line"><span class="comment"># 2.6 在/etc/yum.repo.d/下创建一个repo文件，文件名可以自定义，但一定要以repo结尾，并添加一下内容：</span></div><div class="line">[ultraera.org]	<span class="comment">#仓库名称可以自定义</span></div><div class="line">name=This is a <span class="keyword">local</span> repo	<span class="comment">#描述信息</span></div><div class="line">baseurl=file:///yumload/	<span class="comment">#这里填写仓库的url，注意 有三个正斜线</span></div><div class="line">enabled=<span class="number">1</span>	<span class="comment">#是否开启仓库，1为开启，0为关闭</span></div><div class="line">gpgcheck=<span class="number">0</span>	<span class="comment">#是否检查gpgkey，1为开启，0为关闭</span></div><div class="line"></div><div class="line"><span class="comment"># 2.7 另外如果想要添加软件包group的信息，可以把DVD1中的repodata文件中的*-comps.xml文件，使用ceraterepo -g 加载本地仓库即可，代码如下：</span></div><div class="line">[root<span class="meta">@ultraera</span> repodata]<span class="comment"># createrepo -g [字符可能不一样，后缀正确就行]c6-i386-comps.xml /yumload/</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 2.8 到这里本地yum源就已经搭建完成了，接下来重新初始化yum缓存：</span></div><div class="line">[root<span class="meta">@ultraera</span> repodata]<span class="comment"># yum clean all</span></div><div class="line">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class="line">Cleaning repos: ultraera.org</div><div class="line">Cleaning up Everything</div><div class="line">Cleaning up <span class="keyword">list</span> of fastest mirrors</div><div class="line">[root<span class="meta">@ultraera</span> repodata]<span class="comment"># yum makecache</span></div><div class="line">Loaded plugins: fastestmirror, refresh-packagekit, security</div><div class="line">Determining fastest mirrors</div><div class="line">ultraera.org	| <span class="number">2.9</span> kB	<span class="number">00</span>:<span class="number">00</span> ...</div><div class="line">ultraera.org/filelists_db	| <span class="number">4.9</span> MB	<span class="number">00</span>:<span class="number">00</span> ...</div><div class="line">ultraera.org/primary_db	| <span class="number">3.5</span> MB	<span class="number">00</span>:<span class="number">00</span> ...</div><div class="line">ultraera.org/other_db	| <span class="number">2.1</span> MB	<span class="number">00</span>:<span class="number">00</span> ...</div><div class="line">Metadata Cache Created</div><div class="line"></div><div class="line"><span class="comment"># 2.9 测试group信息是否添加正确可以用如下代码，只要有正确输出信息就表示成功了</span></div><div class="line">[root<span class="meta">@ultraera</span> ~]<span class="comment"># yum grouplist</span></div></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2016/03/29/linux-de-san-ge-te-shu-quan-xian/" class="prev">PREV</a><a href="/2016/03/27/mongodb01/" class="next">NEXT</a></div><div class="copyright"><p>© 2012 - 2017 <a href="https://samzong.me">SAMZONG</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>