<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Tomcat(3) 优化设定 · SAMZONG</title><meta name="description" content="Tomcat(3) 优化设定 - SAMZONG"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://samzong.me/atom.xml" title="SAMZONG"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Tomcat(3) 优化设定</h1><div class="post-info">Jun 16, 2016</div><div class="post-content"><ul>
<li>设置JVM空间大小，Xms和Xmx一样大：JVM初始分配的内存由-Xms指定，默认是物理内存的1/64；JVM最大分配的内存由-Xmx指定，默认是物理内存的1/4。默认空余堆内存小于 40%时，JVM就会增大堆直到-Xmx的最大限制；空余堆内存大于70%时，JVM会减少堆直到-Xms的最小限制。因此服务器一般设置-Xms、 -Xmx相等以避免在每次GC 后调整堆的大小。</li>
<li>关闭dns查询</li>
<li>增加线程数量</li>
<li>maxThreads、acceptCount ： 增加并发，同时增加这两个的数量</li>
<li><p>内存优化 ： /tomcatbin/catalina.sh</p>
</li>
<li><p>JAVA_OPTS=”-XX:PermSize=64M -XX:MaxPermSize=128m -Xms512m -Xmx1024m -Duser.timezone=Asia/Shanghai”</p>
</li>
<li>缓存优化</li>
<li>并发优化，线程优化</li>
<li>&lt;Connector port=”80” protocol=”HTTP/1.1” maxThreads=”600” minSpareThreads=”100” maxSpareThreads=”500” acceptCount=”700”</li>
<li>connectionTimeout=”20000” redirectPort=”8443” /&gt;</li>
<li>关闭DNS查询 :修改server.xml文件中的Connector元素，修改属性enableLookups参数值: enableLookups=”false”</li>
<li><p>使用apr插件，提高tomcat响应时间 <br></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">(1)安装APR tomcat-native</div><div class="line">  apr-1.3.8.tar.gz   安装在/usr/local/apr</div><div class="line"><span class="meta">  #</span><span class="bash">tar zxvf apr-1.3.8.tar.gz</span></div><div class="line"><span class="meta">  #</span><span class="bash"><span class="built_in">cd</span> apr-1.3.8</span></div><div class="line"><span class="meta">  #</span><span class="bash">./configure;make;make install</span></div><div class="line"></div><div class="line">  apr-util-1.3.9.tar.gz  安装在/usr/local/apr/lib</div><div class="line"><span class="meta">  #</span><span class="bash">tar zxvf apr-util-1.3.9.tar.gz</span></div><div class="line"><span class="meta">  #</span><span class="bash"><span class="built_in">cd</span> apr-util-1.3.9</span></div><div class="line"><span class="meta">  #</span><span class="bash">./configure --with-apr=/usr/<span class="built_in">local</span>/apr ----with-java-home=JDK;make;make install</span></div><div class="line"><span class="meta"></span></div><div class="line">  #<span class="bash"><span class="built_in">cd</span> apache-tomcat-6.0.20/bin</span></div><div class="line"><span class="meta">  #</span><span class="bash">tar zxvf tomcat-native.tar.gz</span></div><div class="line"><span class="meta">  #</span><span class="bash"><span class="built_in">cd</span> tomcat-native/jni/native</span></div><div class="line"><span class="meta">  #</span><span class="bash">./configure --with-apr=/usr/<span class="built_in">local</span>/apr;make;make install</span></div><div class="line"></div><div class="line">(2)设置 Tomcat 整合 APR</div><div class="line">  修改 tomcat 的启动 shell （startup.sh），在该文件中加入启动参数：</div><div class="line">    CATALINA_OPTS="$CATALINA_OPTS -Djava.library.path=/usr/local/apr/lib" 。</div><div class="line"></div><div class="line">(3)判断安装成功:</div><div class="line">  如果看到下面的启动日志，表示成功。</div><div class="line">    2007-4-26 15:34:32 org.apache.coyote.http11.Http11AprProtocol init</div></pre></td></tr></table></figure>
</li>
<li><p>开启manager 管理</p>
</li>
<li>使用<a href="http://visualvm.Java.net/download.html" target="_blank" rel="external">http://visualvm.Java.net/download.html</a> 工具监控tomcat的性能</li>
<li>JAVA_OPTS=’-Dcom.sun.management.jmxremote.port=8999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false’</li>
<li>设置自动更新autodeploy＝false</li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2016/06/16/mysql03/" class="prev">PREV</a><a href="/2016/06/16/shi-yong-moshdai-ti-sshlian-jie-fu-wu-qi/" class="next">NEXT</a></div><div class="copyright"><p>© 2012 - 2017 <a href="https://samzong.me">SAMZONG</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>