<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> MySQL(7) 索引创建、删除和查看 · SAMZONG</title><meta name="description" content="MySQL(7) 索引创建、删除和查看 - SAMZONG"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://samzong.me/atom.xml" title="SAMZONG"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">MySQL(7) 索引创建、删除和查看</h1><div class="post-info">Feb 9, 2017</div><div class="post-content"><h4 id="1-索引的作用"><a href="#1-索引的作用" class="headerlink" title="1. 索引的作用"></a><strong>1. 索引的作用</strong></h4><p>   在索引列上，数据库利用各种各样的快速定位技术，能够大大的提高查询效率，特别是当数据量非常大和查询设计到多个表时，索引的利用能够将效率提高成千上万倍，当然要合理的利用索引。</p>
<h4 id="2-创建索引"><a href="#2-创建索引" class="headerlink" title="2. 创建索引"></a><strong>2. 创建索引</strong></h4><p>​    在执行CREATE TABLE时可以创建索引，也可以在之后单独使用CREATE INDEX或ALTER TABLE来为表增加索引。</p>
<h6 id="2-1-ALTER-TABLE"><a href="#2-1-ALTER-TABLE" class="headerlink" title="2.1 ALTER TABLE"></a>2.1 ALTER TABLE</h6><p>​    ALTER TABLE用来创建普通索引、UNIQUE索引或PRIMARY KEY索引。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name <span class="keyword">ADD</span> <span class="keyword">INDEX</span> index_Name (column_list);</div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> (column_list);</div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name <span class="keyword">ADD</span> PRIMARY <span class="keyword">KEY</span> (column_list);</div></pre></td></tr></table></figure>
<p>​    tb_name 是要增加索引的表名，column_list 是要增加索引的列，多列用逗号隔开，index_Name 是可选，缺省为第一个索引列赋名称，ALTER TABLE允许在单个语句中更改多个表，因此可以也可以同时创建多个索引。</p>
<h6 id="2-2-CREATE-INDEX"><a href="#2-2-CREATE-INDEX" class="headerlink" title="2.2 CREATE INDEX"></a>2.2 CREATE INDEX</h6><p>​    CREATE INDEX 可对表增加普通索引或者UNIQUE索引。</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_Name <span class="keyword">ON</span> tb_name(column_list);</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> index_Name <span class="keyword">ON</span> tb_name(column_list);</div></pre></td></tr></table></figure>
<p>​    tb_name、index_Name和column_list具有ALTER TABLE语句中相同的含义，索引名称不可自定义，也不能创建PRIMARY KEY。</p>
<h4 id="3-索引类型"><a href="#3-索引类型" class="headerlink" title="3. 索引类型"></a><strong>3. 索引类型</strong></h4><p>​    在创建索引时，可以规定索引能否包含重复的值，如果不包含，则索引应该为PRIMARY KEY或UNIQUE索引，对于单列唯一索引，这能保证单列不包含重复的值，对于多列唯一索引，保证多值的组合不重复。</p>
<p>​    PRIMAY KEY索引与UNIQUE索引非常类似，实际上PRIMAY KEY索引仅是一个具有名称PRIMAY的UNIQUE索引，这表示一个表只能包含一个PRIMAY KEY索引，因为一个表中不可能具有两个同名的索引。</p>
<h4 id="4-删除索引"><a href="#4-删除索引" class="headerlink" title="4. 删除索引"></a><strong>4. 删除索引</strong></h4><p>​    可以使用ALTER TABLE或DROP INDEX语句来删除索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_Name <span class="keyword">On</span> tb_name;</div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_Name <span class="keyword">DROP</span> <span class="keyword">TABLE</span> index_Name;</div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_Name <span class="keyword">DROP</span> PRIMAY <span class="keyword">KEY</span>;</div></pre></td></tr></table></figure>
<p>​    第一条和第二条作用是一样的，删除tb_Name中index_Name索引；第三条仅适用于删除PRIMAY KEY时，因为一个只可能有一个PRIMAY KEY索引。</p>
<p>​    另外，如果在表中删除了某列，则索引会受到影响，对于多列组合的索引，如果删除其中某列，则该列也会在索引中删除，如果删除所有列，则该索引也会被删除。</p>
<h4 id="5-查看索引"><a href="#5-查看索引" class="headerlink" title="5. 查看索引"></a><strong>5. 查看索引</strong></h4><figure class="highlight q"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; <span class="built_in">show</span> index <span class="keyword">from</span> tb_name;</div><div class="line">mysql&gt; <span class="built_in">show</span> <span class="built_in">keys</span> <span class="keyword">from</span> tb_name;</div></pre></td></tr></table></figure>
<ul>
<li>Table : 表名</li>
<li>Non_unique： 如果索引不能包含重复值为0，如果可以为1</li>
<li>Key_name： 索引的名称</li>
<li>Seq_in_index：索引中列的序号，从1开始</li>
<li>Column_name： 列的名称</li>
<li>Collation：列以什么方式存储在索引中，在MySQL中有值‘A’(升序)和NULL(无分类)</li>
<li>Cardinality： 索引中唯一值的数量估计值，通过运行ANALYZE TABLE或者 myisamchk -a 可以更新，基数根据被存储的整数的统计数据来计数，所以，即使对于小型表，该值也没有必要是精确的，基数越大，当进行联合时，MySQL使用该索引的机会就越大。</li>
<li>Sub_part： 如果列只是被部分编入，则为编入索引的字符数目，如果整列被编入索引，则为NULL</li>
<li>Packed：关键字如何被压缩，没有压缩为NULL</li>
<li>Null： 如果列含有NULL为YES，如果没有则为NO</li>
<li>Index_type： 用过的索引方法，BTREE，FULLTEXT，HASH，RTREE</li>
<li>Comment： 备注</li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2017/02/19/howto-automatic-updates-centos-rhel-using-yum/" class="prev">PREV</a><a href="/2017/01/18/zabbix01-monitor-tomcat-head-memory-jmx/" class="next">NEXT</a></div><div class="copyright"><p>© 2012 - 2017 <a href="https://samzong.me">SAMZONG</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>